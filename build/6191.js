"use strict";(globalThis.webpackChunkpropovoice=globalThis.webpackChunkpropovoice||[]).push([[6191],{88477:(e,t,a)=>{a.d(t,{A:()=>l});var r=a(57536),s=a(60235);const n=s.y0+"payment-process",l={getAll:(e="")=>r.A.get(`${n}/?${e}`,s.Sh),create:e=>r.A.post(n,e,s.Sh)}},96062:(e,t,a)=>{a.d(t,{A:()=>s});var r=a(51609);const s=()=>(0,r.createElement)("svg",{width:25,height:25,viewBox:"0 0 16 16",fill:"none"},(0,r.createElement)("path",{d:"M12.5 3.5L3.5 12.5",stroke:"#718096",strokeLinecap:"round",strokeLinejoin:"round"}),(0,r.createElement)("path",{d:"M12.5 12.5L3.5 3.5",stroke:"#718096",strokeLinecap:"round",strokeLinejoin:"round"}))},30396:(e,t,a)=>{a(51609)},65279:(e,t,a)=>{a(51609)},13603:(e,t,a)=>{a(51609)},26587:(e,t,a)=>{a(51609)},43209:(e,t,a)=>{a(51609)},71983:(e,t,a)=>{a(51609)},50285:(e,t,a)=>{a(51609)},54143:(e,t,a)=>{a(51609)},43065:(e,t,a)=>{a.d(t,{OM:()=>r.A}),a(30396),a(65279),a(26587),a(71983),a(54143),a(43209),a(13603);var r=a(96062);a(50285)},88572:(e,t,a)=>{a.r(t),a.d(t,{default:()=>E});var r=a(51609),s=a(43065),n=a(57536),l=a(37427),o=a(22926),i=a(21241),c=a(60235),m=a(88477);const p={iconStyle:"solid",style:{base:{iconColor:"#4e6de9",color:"#000",fontWeight:500,fontSize:"16px",fontSmoothing:"antialiased",":-webkit-autofill":{color:"#1a202c"},"::placeholder":{color:"#777777"}},invalid:{iconColor:"#b30000",color:"#b30000"}}},d=({processing:e,error:t,children:a,disabled:s})=>(0,r.createElement)("div",{className:"row"},(0,r.createElement)("div",{className:"col"},(0,r.createElement)("button",{className:"pv-btn pv-btn-medium pv-bg-blue pv-bg-hover-blue pv-bg-shadow pv-color-white pv-m-auto SubmitButton "+(t?"SubmitButton--error":""),type:"submit",disabled:e||s},e?"Processing...":a))),h=({children:e})=>(0,r.createElement)("div",{className:"ErrorMessage",role:"alert"},(0,r.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 17 17"},(0,r.createElement)("path",{fill:"#000",d:"M8.5,17 C3.80557963,17 0,13.1944204 0,8.5 C0,3.80557963 3.80557963,0 8.5,0 C13.1944204,0 17,3.80557963 17,8.5 C17,13.1944204 13.1944204,17 8.5,17 Z"}),(0,r.createElement)("path",{fill:"#fff",d:"M8.5,7.29791847 L6.12604076,4.92395924 C5.79409512,4.59201359 5.25590488,4.59201359 4.92395924,4.92395924 C4.59201359,5.25590488 4.59201359,5.79409512 4.92395924,6.12604076 L7.29791847,8.5 L4.92395924,10.8739592 C4.59201359,11.2059049 4.59201359,11.7440951 4.92395924,12.0760408 C5.25590488,12.4079864 5.79409512,12.4079864 6.12604076,12.0760408 L8.5,9.70208153 L10.8739592,12.0760408 C11.2059049,12.4079864 11.7440951,12.4079864 12.0760408,12.0760408 C12.4079864,11.7440951 12.4079864,11.2059049 12.0760408,10.8739592 L9.70208153,8.5 L12.0760408,6.12604076 C12.4079864,5.79409512 12.4079864,5.25590488 12.0760408,4.92395924 C11.7440951,4.59201359 11.2059049,4.59201359 10.8739592,4.92395924 L8.5,7.29791847 L8.5,7.29791847 Z"})),e);class u extends r.Component{constructor(e){super(e),this.state={error:null,cardComplete:!1,processing:!1,paymentMethod:null,form:{email:"",phone:"",name:""}}}handleChange=e=>{const{name:t,value:a}=e.target;this.setState({form:{...this.state.form,[t]:a}})};handleSubmit=async e=>{e.preventDefault();const{stripe:t,elements:a}=this.props,{error:r,cardComplete:s}=this.state,{email:l,phone:p,name:d}=this.state.form;if(!t||!a)return;const h=a.getElement(o.CardElement);if(null==h)return;if(r)return void h.focus();this.setState({processing:!0});const u=c.BB+"payment-process";let v=!1,E="";this.props.type&&"package"==this.props.type&&(v=!0,E="&is_package=1");const g=await n.A.get(`${u}/?type=payment_indent&id=${this.props.invoice.id}&email=${l}${E}`);if(g){const e=g.data.data,a=e.intent_obj.client_secret,r=e.subscription_id,s=await t.createPaymentMethod({type:"card",card:h,billing_details:{address:{city:""},email:l,phone:p,name:d}});if(s.error)this.setState({error:s.error});else{const e=await t.confirmCardPayment(a,{payment_method:s.paymentMethod.id});if(e.error)this.setState({processing:!1,error:e.error});else{this.setState({processing:!1,paymentMethod:e});let t=e.paymentIntent,a={invoice_id:this.props.invoice.id,payment_method:"stripe",payment_info:{id:t.id,subscription_id:r,amount:t.amount,currency:t.currency,billing_address:this.state.form,created:t.created}};v&&(a.type="package"),m.A.create(a).then((e=>{e.data.success||i.oR.error("Invalid submission!!!")}))}}}};render(){const{error:e,processing:t,paymentMethod:a}=this.state,{stripe:n}=this.props,l=ndpv.i18n;return(0,r.createElement)("div",{className:"pv-overlay pv-show"},(0,r.createElement)("div",{className:"pv-modal-content pv-modal-style-two pv-modal-small"},(0,r.createElement)("div",{className:"pv-modal-header"},(0,r.createElement)("span",{className:"pv-close",onClick:()=>this.props.close()},(0,r.createElement)(s.OM,null)),(0,r.createElement)("h2",{className:"pv-modal-title"},l.pay," ",l.with," ",l.stripe)),(0,r.createElement)("div",{className:"pv-content"},a?(0,r.createElement)("div",{className:"Result"},(0,r.createElement)("div",{className:"ResultTitle",role:"alert"},l.payment," ",l.succ),(0,r.createElement)("div",{className:"ResultMessage"},"Thanks for trying ",l.stripe," payment.",(0,r.createElement)("div",{style:{marginTop:"7px",color:"#000"}},(0,r.createElement)("b",null,l.txn," ",l.id,":")," ",a.paymentIntent.id))):(0,r.createElement)("form",{onSubmit:this.handleSubmit,className:"pv-form-style-one"},(0,r.createElement)("div",{className:"row"},(0,r.createElement)("div",{className:"col-lg"},(0,r.createElement)("label",{htmlFor:"form-name"},l.name),(0,r.createElement)("input",{id:"form-name",type:"text",required:!0,name:"name",value:this.state.form.name,onChange:this.handleChange}))),(0,r.createElement)("div",{className:"row"},(0,r.createElement)("div",{className:"col-lg"},(0,r.createElement)("label",{htmlFor:"form-name"},l.email),(0,r.createElement)("input",{id:"form-email",type:"email",required:!0,name:"email",value:this.state.form.email,onChange:this.handleChange}))),(0,r.createElement)("div",{className:"row"},(0,r.createElement)("div",{className:"col-lg"},(0,r.createElement)(o.CardElement,{options:p,onChange:e=>{this.setState({error:e.error,cardComplete:e.complete})}}))),e&&(0,r.createElement)("div",{className:"row"},(0,r.createElement)("div",{className:"col-lg"},(0,r.createElement)(h,null,e.message))),(0,r.createElement)(d,{processing:t,error:e,disabled:!n},l.pay)))))}}class v extends r.Component{constructor(e){super(e)}render(){let e=this.props.invoice.payment_methods.stripe.public_key;const t=(0,l.c)(e);return(0,r.createElement)(r.Fragment,null,this.props.show&&(0,r.createElement)(o.Elements,{stripe:t},(0,r.createElement)(o.ElementsConsumer,null,(({stripe:e,elements:t})=>(0,r.createElement)(u,{stripe:e,elements:t,...this.props})))))}}const E=v}}]);